@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication;

@inject HttpClient httpClient
@inject IAccessTokenProvider accessTokenProvider

@if (history?.Length > 0) {
    <MatListGroup>
        <MatListGroupSubHeader>Zuletzt gespielte Runden:</MatListGroupSubHeader>
        <MatList SingleSelection="true" TwoLine="true">
            @foreach (var entry in history)
            {
                <MatListItem>
                    <MatListItemText>
                        @if(entry.GameResult == "Loose") {
                            <MatListItemPrimaryText>Verloren gegen @entry.Opponent</MatListItemPrimaryText>
                        } else if (entry.GameResult == "Tie"){
                            <MatListItemPrimaryText>Unentschieden gegen @entry.Opponent</MatListItemPrimaryText>
                        } else {
                            <MatListItemPrimaryText>Gewonnen gegen @entry.Opponent</MatListItemPrimaryText>
                        }
                        <MatListItemSecondaryText>@entry.SessionDate.ToShortDateString() @entry.SessionDate.ToShortTimeString()</MatListItemSecondaryText>
                    </MatListItemText>
                </MatListItem>
            }
        </MatList>
    </MatListGroup>
}

@code{
    private GameHistory[] history;
    protected override async Task OnInitializedAsync() 
    {
        history = await httpClient.GetFromJsonAsync<GameHistory[]>("GamesHistory");
    }
}